# coding:utf-8

from src.custom_estimator import CustomFormatter
from src.posture import Posture
from openpifpaf import predict
from src.tts import TTS

if __name__ == '__main__':
    # 91.5071935784945 123.9635648943803
    # 70.17264972864426 134.27465492504083
    p = '[{"keypoints": [203.26, 135.15, 0.51, 204.47, 125.27, 0.51, -6.0, -2.0, 0.0, 242.72, 107.57, 0.46, -6.0, -2.0, 0.0, 319.87, 125.81, 0.42, 282.44, 112.03, 0.28, 237.12, 177.62, 0.86, 220.59, 141.05, 0.29, 183.56, 157.62, 0.4, 171.85, 148.71, 0.4, 368.2, 253.97, 0.26, 336.76, 241.86, 0.19, 223.72, 312.84, 0.25, 234.99, 258.77, 0.15, -6.0, -2.0, 0.0, -6.0, -2.0, 0.0], "bbox": [154.99, 89.9, 240.21, 247.29], "score": 0.38, "category_id": 1}]'
    # 113.3887349317874 133.78706343963447
    # 111.52862780207776 165.38861239174173
    p2 = '[{"keypoints": [200.25, 132.25, 0.81, -6.0, -6.0, 0.0, 198.45, 120.86, 0.79, -6.0, -6.0, 0.0, 171.68, 110.42, 0.81, 156.75, 157.46, 0.53, 154.28, 161.24, 0.83, 187.16, 200.04, 0.42, 178.22, 218.93, 0.86, 225.01, 206.17, 0.32, 229.3, 211.67, 0.94, 153.71, 287.65, 0.49, 144.75, 288.31, 0.74, 279.68, 345.66, 0.41, 248.79, 333.1, 0.54, 154.96, 404.36, 0.26, 156.31, 413.5, 0.65], "bbox": [125.61, 103.83, 172.87, 327.39], "score": 0.638, "category_id": 1}]'
    # t = Posture(p)
    # t.detect(True)
    # t2 = Posture(p2)
    # t2.detect(True)
    # tt = TTS()
    # tt.voice('熙熙，坐直腰，伸直脖子，别趴着写字。')
    e = CustomFormatter(cfg_path='/home/zhanglei/Gitlab/SittingPostureDetection/config/cfg.ini')
    e.camera_calibration()
    e.inference()
